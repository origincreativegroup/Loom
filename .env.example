# ============================================================================
# Loom OSINT Console - Environment Configuration for Pi-Net
# ============================================================================
#
# Copy this file to .env and customize for your pi-net setup
# Usage: cp .env.example .env
#

# ----------------------------------------------------------------------------
# Ollama Configuration
# ----------------------------------------------------------------------------
# URL to your Ollama instance. Your pi-net has multiple Ollama servers:
#
# Option 1 - Pi-Forge (192.168.50.157:11434) - Recommended for balanced load
OLLAMA_URL=http://192.168.50.157:11434
#
# Option 2 - Pi-5/pi-core (192.168.50.168:11435) - Alternative
# OLLAMA_URL=http://192.168.50.168:11435
#
# Option 3 - AI-Srv (192.168.50.247:11434) - If dedicated to AI workloads
# OLLAMA_URL=http://192.168.50.247:11434
#
# Option 4 - Via Caddy domain (requires reverse proxy setup)
# OLLAMA_URL=https://ollama.lan

# Ollama model to use for query planning and synthesis
# Examples: llama3.2:latest, mistral:latest, phi3:latest, mixtral:latest
# Run 'ollama list' on your Ollama host to see available models
OLLAMA_MODEL=llama3.2:latest

# ----------------------------------------------------------------------------
# Search Configuration
# ----------------------------------------------------------------------------
# Your pi-net has SearXNG running on Pi-Core (192.168.50.168:8888)
#
# Option 1: Pi-Core SearXNG (RECOMMENDED - local, private, fast)
SEARXNG_URL=http://192.168.50.168:8888
#
# Option 2: Via Caddy reverse proxy (if configured)
# SEARXNG_URL=https://search.lan
#
# Option 3: Use a public SearXNG instance (fallback only)
# SEARXNG_URL=https://search.bus-hit.me
#
# Note: SpiderFoot (spider.lan) and IntelOwl (intelowl.lan) are available
# but have different APIs. SearXNG is recommended for Loom's workflow.

# ----------------------------------------------------------------------------
# Data Storage
# ----------------------------------------------------------------------------
# Directory where case data will be stored
# Default: /data (as mapped in docker-compose.yml)
DATA_DIR=/data

# ----------------------------------------------------------------------------
# OSINT Tool Integrations
# ----------------------------------------------------------------------------

# --- Recon-ng (SSH to Pi-Core) ---
# SSH connection for running Recon-ng on pi-core
PICORE_SSH_HOST=192.168.50.168
PICORE_SSH_USER=admin
# Path to SSH private key (mount as volume in docker-compose.yml)
PICORE_SSH_KEY=/app/keys/id_ed25519

# --- SpiderFoot (API) ---
# SpiderFoot instance for OSINT automation
# Option 1: Via Caddy domain (recommended)
SPIDERFOOT_URL=https://spider.lan
# Option 2: Direct IP
# SPIDERFOOT_URL=http://192.168.50.199:5001
SPIDERFOOT_API_KEY=

# --- IntelOwl (API) ---
# IntelOwl instance for threat intelligence
# Option 1: Via Caddy domain (recommended)
INTELOWL_URL=https://intelowl.lan
# Option 2: Direct IP
# INTELOWL_URL=http://192.168.50.199:8089
INTELOWL_API_KEY=

# ----------------------------------------------------------------------------
# Database Configuration
# ----------------------------------------------------------------------------

# --- CouchDB ---
# Used for storing OSINT scan results
# Your pi-net has CouchDB at https://couchdb.lan
COUCHDB_URL=https://couchdb.lan
COUCHDB_USER=admin
COUCHDB_PASS=CHANGE_ME_IN_PRODUCTION
COUCHDB_DB=osint_scans

# --- PostgreSQL ---
# Used for logging OSINT activities (automation database on pi-core)
POSTGRES_HOST=192.168.50.168
POSTGRES_PORT=5433
POSTGRES_DB=automation
POSTGRES_USER=postgres
POSTGRES_PASS=

# ----------------------------------------------------------------------------
# Security (Optional for Local/LAN Use)
# ----------------------------------------------------------------------------
# API key for securing the Loom API
# For local/LAN use: Leave blank (no authentication)
# For external exposure: Set a strong key (openssl rand -base64 32)
# The UI will send this key automatically via X-API-Key header
OSINT_API_KEY=

# Environment: development, staging, production
# For local/LAN use: Keep as 'development' (SSL verification disabled for .lan domains)
# For external exposure: Set to 'production' (enables strict security)
ENVIRONMENT=development

# Allowed CORS origins (comma-separated)
# Default is fine for local/LAN use - only change if you get CORS errors
ALLOWED_ORIGINS=http://localhost:8788,http://localhost:3000

# Allowed hosts (comma-separated)
# Default covers most local scenarios
ALLOWED_HOSTS=localhost,127.0.0.1,loom.lan,*.lan

# Input validation limits
MAX_TARGET_LENGTH=255
MAX_TITLE_LENGTH=200
MAX_DESCRIPTION_LENGTH=1000

# ----------------------------------------------------------------------------
# Network Configuration (Reference)
# ----------------------------------------------------------------------------
# These are used in docker-compose.yml
# UI Port: 8788 (Nginx serving frontend)
# API Port: 8787 (FastAPI backend)
#
# Recommended deployment hosts for your pi-net:
#
# Option 1 - NexusNAS (192.168.50.199) - RECOMMENDED
#   Pros: Always-on, centralized with other services, plenty of resources
#   Access: http://192.168.50.199:8788 (UI), http://192.168.50.199:8787 (API)
#   Add to Caddy for: https://loom.lan
#
# Option 2 - pi-net Gateway (192.168.50.70)
#   Pros: Gateway device, high availability
#   Access: http://192.168.50.70:8788 (UI), http://192.168.50.70:8787 (API)
#   Add to Caddy for: https://loom.lan
#
# Option 3 - Pi-Forge (192.168.50.157) or Pi-5 (192.168.50.168)
#   Pros: Colocated with Ollama for lower latency
#   Access: http://<pi-ip>:8788 (UI), http://<pi-ip>:8787 (API)
#
# ----------------------------------------------------------------------------
# Caddy Reverse Proxy Setup (Optional but Recommended)
# ----------------------------------------------------------------------------
# Add to /etc/caddy/Caddyfile on pi-net (192.168.50.70):
#
# loom.lan {
#     reverse_proxy <loom-host-ip>:8788
# }
#
# loom-api.lan {
#     reverse_proxy <loom-host-ip>:8787
# }
#
# Then access via:
#   - https://loom.lan (UI)
#   - https://loom-api.lan/docs (API docs)
#
# Don't forget to add DNS entries to /etc/dnsmasq.d/02-lan-hosts.conf
